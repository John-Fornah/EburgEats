<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!--bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!--Custom css-->
    <link rel="stylesheet" href="{{ url_for('static',filename='restaurant-temp/restaurant-temp-style.css')}}">
    <link rel="stylesheet" href="{{ url_for('static',filename='restaurant-temp/review-post-page/review-page.css')}}">
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Josefin+Sans:wght@300;700&family=Montserrat:wght@700;900&family=Overpass:wght@200;300;400&display=swap"
          rel="stylesheet">
    <!--icons-->
    <script src="https://kit.fontawesome.com/8ec657d8d9.js" crossorigin="anonymous"></script>
    {% for restaurant in restaurants %}
    <title> {{restaurant.name}}</title>
</head>
<header>
    <!--Navigation bar-->
    <nav class="navbar navbar-expand-lg bg-dark navbar-dark padding-top padding-bottom">
        <div class="container">
            <a href="{{ url_for('home') }}" class="navbar-brand logo">EBURG EATS</a>

            <div class="search-box margin-right margin-left">
                <!--Search Bar-->
                <div class="input-group">
                    <label for="search-bar"></label>
                    <input type="search" class="form-control search-style body-txt" placeholder="Search"
                           id="search-bar"/>
                    <button class="input-group-text border-0 light-red-bg"
                            style="border:none;">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navmenu">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse text-nowrap" id="navmenu">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a href="{{ url_for('account') }}" class="nav-link btn-style margin-right text-white">MY
                            ACCOUNT</a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('popular') }}" class="nav-link btn-style margin-right text-white">MOST
                            POPULAR</a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('additions') }}" class="nav-link btn-style margin-right text-white">NEWEST
                            ADDITIONS</a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('favorite') }}" class="nav-link btn-style margin-right text-white">YOUR
                            FAVORITES</a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('login') }}" class="nav-link btn-style margin-right text-white">LOG
                            IN</a>
                    </li>
                    <li class="nav-item">
                        <a href="{{ url_for('register') }}" class="nav-link btn-style text-white">SIGN UP</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<section class="text-center">
    <div class="container d-sm-flex justify-content-center">
        <div class="row">
            <div class="post form-group d-sm">
                <div class="mt-5">
                    <h1 class="d-flex text-nowrap restaurant-name text-uppercase header-1 margin-top">{{ restaurant.name }}</h1>
                </div>
                {% for review in form.ReviewForm %}
                <div class="d-sm-flex">
                    {{ review.rating }}
                    <div class="rate">
                        <form id="ratings-form" method="GET" action="">
                             <input type="radio" id="star1" name="rate" value="1" style="display: none"/>
                            <label class="star-icon" data-index="0" for="star1" title="text">
                                <i class="fas fa-star"></i>
                            </label>

                            <input type="radio" id="star2" name="rate" value="2" style="display: none"/>
                            <label class="star-icon" data-index="1" for="star2" title="text">
                                <i class="fas fa-star"></i>
                            </label>

                            <input type="radio" id="star3" name="rate" value="3" style="display: none"/>
                            <label class="star-icon" data-index="2" for="star3" title="text">
                                <i class="fas fa-star"></i>
                            </label>

                            <input type="radio" id="star4" name="rate" value="4" style="display: none"/>
                            <label class="star-icon" data-index="3" for="star4" title="text">
                                <i class="fas fa-star"></i>
                            </label>

                            <input type="radio" id="star5" name="rate" value="5" style="display: none"/>
                            <label class="star-icon" data-index="4" for="star5" title="text">
                                <i class="fas fa-star"></i>
                            </label>
                        </form>
                    </div>
                </div>
                <!--REVIEW POST-->
                <form method="GET">
                    {{ review.review }}
                    <label for="reviewPost">
                    <textarea id="reviewPost" class="body-txt" name="reviewPost" placeholder="Write a Review..."
                              cols="75"
                              rows="10"></textarea>
                        <br>
                        {{ form.submit(class = "d-flex margin-top btn btn-lg shadow-none btn-style light-red-bg") }}
                    </label>
                </form>

                <!--PHOTO POST-->
                <div>
                    <h2 class="d-flex text-nowrap post-a-photo text-uppercase header-2 margin-top"
                        style="margin-bottom: 0">Post a Photo</h2>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
<section>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
</section>
{% endfor %}
<!-- Footer -->
<footer class="bg-dark text-center text-white">
    <!-- Grid container -->
    <div class="d-sm-flex justify-content-center align-items-center">
        <div class="row d-sm-flex justify-content-center">
            <div class="linkedin-container">
                <div class="linkedin-btns">
                    <!-- Github -->
                    <a class="btn btn-outline-light btn-floating shadow-none git-btn m-1"
                       href="https://github.com/John-Fornah/EburgEats"><i class="fab fa-github-alt"></i></a>

                    <a class="btn btn-outline-light btn-floating m-1 shadow-none" href="#" role="button"
                    ><i class="fa-solid fa-a"></i></a>
                    <a class="btn btn-outline-light btn-floating m-1 shadow-none" href="#" role="button"
                    ><i class="fa-solid fa-c"></i></a>
                    <a class="btn btn-outline-light btn-floating m-1 shadow-none" href="#" role="button"
                    ><i class="fa-solid fa-g"></i
                    ></a>
                    <a class="btn btn-outline-light btn-floating m-1 shadow-none" href="#" role="button"
                    ><i class="fa-solid fa-j"></i
                    ></a>
                    <a class="btn btn-outline-light btn-floating m-1 shadow-none" href="#" role="button"
                    ><i class="fa-solid fa-l"></i
                    ></a>
                </div>
            </div>
        </div>
    </div>
    <!-- Copyright -->
    <div class="text-center p-3 footer-txt text-uppercase" style="background-color: rgba(0, 0, 0, 0.2);">
        Copyright Â© 2021 EburgEats
    </div>
</footer>
<!--bootstrap-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
<!--jquery-->
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script>
    var rating = -1, userID = 0; //User haven't rated

    $(document).ready(function () {
        resetStarColors();
        //Logs user review to database
        if (localStorage.getItem('rating') != null)
            setStars(parseInt(localStorage.getItem('rating')));

        //Logs the review on click
        $('.star-icon').on('click', function () {
            rating = parseInt($(this).data('index'));
            localStorage.setItem('rating', rating);
            saveToDB();
        });

        //Logs the number of stars
        $('.star-icon').mouseover(function () {
            resetStarColors();
            var currentIndex = parseInt($(this).data('index'));
            setStars(currentIndex);
        })

        $('.star-icon').mouseleave(function () {
            resetStarColors();
            if (rating !== -1)
                setStars(rating);
        })
    });

    function saveToDB() {
        $.ajax({
            method: "POST",
            data: {
                save: 1,
                userID: userID,
                rating: rating
            }, success: function (r) {
                userID = r.userID;
            }
        })
    }

    //Sets the max
    function setStars(max) {
        for (var i = 0; i <= max; i++)
            $('.star-icon:eq(' + i + ')').css('color', '#ab0032');
    }

    //Resets the colors of the stars to unclicked
    function resetStarColors() {
        $('.star-icon').css('color', '#ddd');
    }
</script>
</html>